
albums_and_tracks = {'Руки Вверх': [[1], [
    {'Медляки': [[['Алёшка', 3, 25], ['Доброй, нежной, ласковой', 3, 42], ['Уходи', 3, 53],
                  ['Не зови меня красивою', 5, 15], ['Не бойся, я с тобой', 3, 55], ['У реки девчонка', 4, 37],
                  ['Больно', 4, 1], ['Я буду ждать', 4, 13], ['Мама', 4, 14],
                  ['Девочка из прошлого', 3, 33], ['Увидимся в снах', 3, 26], ['Мой омут', 4, 48],
                  ['Территория', 4, 7], ['Она одна', 4, 53], ['Нежность', 3, 45],
                  ['Десять лет', 4, 20], ['Капают слёзы', 4, 14], ['Летний вечер', 4, 23],
                  ['Ты зачем говоришь о любви', 4, 18]], [2014]],
     'Танцы': [[['Танцы', 4, 3]], [2018]]}]],
                     'Zivert': [[1], [
                         {'Сияй': [[['Ещё хочу', 3, 25], ['Зелёные волны', 3, 43], ['Сияй', 3, 24],
                                    ['Мой океан', 3, 24]], [2018]]}]],
                     'Тима Белорусских': [[1], [
                         {'Моя кассета — твой первый диск': [[['Повторим (Intro)', 0, 9], ['Повторим', 2, 36],
                                                              ['Подземка (Intro)', 0, 9], ['Подземка', 2, 47],
                                                              ['Одуванчик (Intro)', 0, 14], ['Одуванчик', 3, 2],
                                                              ['Во дворе (Intro)', 0, 5], ['Во дворе', 3, 43],
                                                              ['Птичка (Intro)', 0, 11], ['Птичка', 2, 55],
                                                              ['Любовь по-белорусски (Intro)', 0, 11],
                                                              ['Любовь по-белорусски', 2, 58],
                                                              ['Не меняй (Intro)', 0, 6],
                                                              ['Не меняй', 3, 15]], [2020]]}]],
                     'Jony': [[1, 2, 3], [
                         {'Небесные розы': [[['Ты пари', 3, 54], ['А за окном дожди', 2, 14], ['Мир сошёл с ума', 3, 40],
                                             ['Небесные розы', 3, 0], ['Ты беспощадна', 4, 3]], [2020]]}]],
                     'Юрий Шатунов': [[4], [
                         {'Не молчи...': [[['С днём рождения', 4, 18], ['Одноклассники', 3, 51],
                                           ['И я под гитару', 3, 48], ['Не молчи', 3, 40], ['Грёзы', 3, 50],
                                           ['А он любил', 2, 50]], [2018]]}]],
                     'Ани Лорак': [[1], [
                         {'За мечтой': [[['Мы нарушаем', 3, 50], ['Небо', 3, 3], ['Я тебя ждала', 3, 26],
                                         ['Запомни эту любовь', 3, 19], ['Я там, где ты', 2, 40],
                                         ['Я бы летала', 2, 52]], [2019]]}]],
                     'Niletto': [[1], [
                         {'ПРОСТЫМ': [[['Я стану простым (Intro)', 0, 30], ['Я стану простым', 4, 4],
                                       ['Повезёт (Intro)', 0, 18], ['Повезёт', 3, 44], ['Сирень (Intro)', 0, 20],
                                       ['Сирень', 2, 53]], [2020]]}]],
                     'Филипп Киркоров': [[4], [
                         {'Романы. Часть 2': [[['Цвет настроения синий', 3, 22], ['Ты', 3, 58], ['Никогда', 3, 47],
                                               ['За горизонты', 3, 31], ['Нет любви на расстоянии', 3, 52],
                                               ['Народная артистка', 4, 49]], [2020]]}]],
                     'Dua Lipa': [[5, 2, 6], [
                         {'Future Nostalgia The Moonlight Edition': [[['Future Nostalgia', 3, 4],
                                                                      ["Don't Start Now", 3, 3],
                                                                      ['Cool', 3, 29], ['My physical', 3, 13],
                                                                      ['Levitating', 3, 23], ['Pretty Please', 3, 14]],
                                                                     [2021]]}]],
                     'Lady Gaga': [[5], [
                         {'Chromatica': [[['Chromatica I', 1, 0], ['Alice', 2, 57], ['Stupid Love', 3, 13],
                                          ['Rain On Me — Lady Gaga, Ariana Grande', 3, 2], ['Free Woman', 3, 11],
                                          ['My Fun Tonight', 2, 53]], [2020]]}]],
                     'BTS': [[7], [
                         {'BE': [[['Life Goes On', 3, 27], ['Fly To My Room', 3, 42], ['Blue & Grey', 4, 14],
                                  ['My Skit', 2, 59], ['Telepathy', 3, 22], ['Dis-ease', 3, 59]], [2020]]}]],
                     'Eminem': [[8], [
                         {'Music To Be Murdered By - Side B': [[['Alfred Intro', 0, 17],
                                                                ['Black Magic — Eminem, Skylar Grey', 2, 54],
                                                                ['Alfred’s Theme', 5, 39], ['Tone Deaf', 4, 50],
                                                                ['Book of Rhymes — Eminem, DJ Premier', 4, 49],
                                                                ['Favorite Bitch — Eminem, Ty Dolla $ign', 3, 56]],
                                                               [2020]]}]],
                     'Shakira': [[5, 9, 2], [
                         {'Shakira In Concert: El Dorado World Tour El Dorado World Tour Live': [[
                             ['Estoy Aqui/Donde Estas Corazon Medley El Dorado World Tour Live', 5, 5],
                             ['She Wolf El Dorado World Tour Live', 5, 40],
                             ['Si Te Vas El Dorado World Tour Live', 4, 12]], [2019]]}]],
                     'Даня Милохин': [[1, 3, 2], [
                         {'БУМ': [[['Лапки', 2, 11], ['Сияй', 2, 13], ['БУМ', 1, 44],
                                   ['Друг', 2, 17], ['Хит на весь блок', 2, 1], ['Единорог', 1, 48]], [2021]]}]],
                     'Sting': [[5, 10, 11], [
                         {'My Songs Deluxe': [[['Brand New Day My Songs Version', 3, 56],
                                               ['Desert Rose My Songs Version', 3, 56],
                                               ['If You Love Somebody Set Them Free My Songs Version', 4, 35],
                                               ['Every Breath You Take My Songs Version', 4, 16],
                                               ['Demolition Man My Songs Version', 4, 17],
                                               ["Can't Stand Losing You My Songs Version", 2, 49]], [2019]]}]],
                     'Selena Gomez': [[5, 2, 12], [
                         {'Revelacion - EP': [[['De Una Vez', 2, 35], ['Buscando Amor', 3, 8],
                                               ['Baila Conmigo — Selena Gomez, Rauw Alejandro', 3, 6],
                                               ['Damelo To — Selena Gomez, Myke Towers', 3, 4], ['Vicio', 2, 40],
                                               ['Adios', 2, 10], ['Selfish Love — Dj Snake, Selena Gomez', 2, 48]],
                                              [2021]]}]],
                     'BlackPink': [[7], [
                         {'THE ALBUM': [[['How You Like That', 3, 0], ['Ice Cream — BLACKPINK, Selena Gomez', 2, 55],
                                         ['Pretty Savage', 3, 19]], [2020]]}]],
                     'Rauf And Faik': [[1, 5], [
                         {'PAIN & MEMORIES': [[['OLA — Rauf & Faik, Никита N.B', 2, 29], ['где солнца нет', 2, 42],
                                               ['любишь и не любишь', 3, 0]], [2019]]}]],
                     'Фактор 2': [[1], [
                         {'Письма': [[['Женюсь - Фактор 2', 3, 15], ['Ути, моя маленькая', 3, 19],
                                      ['Письма Version 2019 — Фактор 2 & JERRY', 3, 41]], [2019]]}]],
                     'MONATIK': [[5], [
                         {'Мріяти не шкідливо': [[['Мріяти не шкідливо', 2, 26], ['Свято наближається', 2, 11],
                                                  ['Батькам', 4, 0], ['Краса', 4, 13]], [2019]]}]],
                     'Эльбрус Джанмирзоев': [[13], [
                         {'Бродяга': [[['Бродяга feat. Alexandros Tsopozidis — Эльбрус Джанмирзоев feat. Alexandros Tsopozidis', 4, 5],
                                       ['Только не бойся', 3, 16], ['Чародейка', 4, 48]], [2016]]}]],
                     'Олег Груз': [[3, 12, 14], [
                         {'Вдох времени': [[['Я родился в большой стране', 2, 46], ['Самая читающая нация', 2, 26],
                                            ['Тут', 2, 52], ['Спасибо браткам', 2, 22], ['Настоящий полковник', 1, 52],
                                            ['Всё могут короли', 2, 55]], [2020]]}]],
                     'Лорд Пневмослон': [[14, 15], [
                         {'Вся хурма': [[['Адовый адок на задок и на передок', 2, 52],
                                         ['Грибочки', 3, 2], ['Серёга', 2, 54]],[2018]]}]],
                     'Tessa B.': [[16, 2, 5], [
                         {'Dans ma tete': [[['Jamais', 3, 2], ['100 ans', 3, 52],
                                            ['O mon Amour feat. Romeo Elvis — Tessa B., Romeo Elvis', 2, 59],
                                            ['Dans ma tete', 3, 31], ['Fais-moi signe', 3, 26],
                                            ['Repose en paix', 3, 56]], [2020]]}]],
                     'Триагрутрика': [[3], [
                         {'By Triagrutrika, Pt. 1': [[['10 Лет', 2, 52], ['Рашн Федерейшн', 3, 33], ['Белокаменная', 3, 21],
                                                      ['Антидепрессант', 4, 39], ['Твой сон', 4, 41], ['Лирика', 4, 40],
                                                      ['Готов ли ты?', 2, 28], ['На море', 3, 37], ['Где-то там', 4, 18],
                                                      ['Флэйва', 4, 4]], [2018]]}]]
                     }

genres_and_id = {1: 'русская поп-музыка', 2: 'танцевальная музыка', 3: 'русский рэп', 4: 'русская эстрада', 5: 'поп',
                 6: 'хаус', 7: 'k-pop', 8: 'иностранный рэп и хип-хоп', 9: 'латиноамериканская музыка',
                 10: 'иностранный рок', 11: 'регги', 12: 'электроника', 13: 'кавказская музыка',
                 14: 'альтернатива', 15: 'ска', 16: 'эстрада'}

collect = {'русская эстрада': [[['С днём рождения', 4, 18], ['Цвет настроения синий', 3, 22],
                               ['Народная артистка', 4, 49]], [2018]],
           'русская поп-музыка': [[['Алёшка', 3, 25], ['Ещё хочу', 3, 25], ['Подземка', 2, 47],
                                   ['Ты пари', 3, 54]], [2021]],
           'Настроение ЛЕТО(русская поп-музыка)': [[['А за окном дожди', 2, 14], ['Мы нарушаем', 3, 50],
                                                    ['Я стану простым', 4, 4]], [2019]],
           'поп vol 1.': [[['Jamais', 3, 2], ['Краса', 4, 13], ['OLA — Rauf & Faik, Никита N.B', 2, 29]], [2020]],
           'Сборник русского рэпа': [[['10 Лет', 2, 52], ['Я родился в большой стране', 2, 46], ['Лапки', 2, 11]],
                                     [2018]],
           'Russian RAP 2020': [[['Единорог', 1, 48], ['Ты пари', 3, 54], ['Готов ли ты?', 2, 28]], [2020]],
           'танцевальная музыка vol 2.': [[['Jamais', 3, 2], ['Adios', 2, 10], ['Хит на весь блок', 2, 1]], [2019]],
           'альтернатива белу свету': [[['Серёга', 2, 54], ['Тут', 2, 52], ['Спасибо браткам', 2, 22]], [2020]],
           'WHAT k-pop?': [[['How You Like That', 3, 0], ['Ice Cream — BLACKPINK, Selena Gomez', 2, 55],
                            ['Fly To My Room', 3, 42], ['Blue & Grey', 4, 14]], [2019]]}


def insert_data(connection):
    # Заполняем таблицу именами исполнителей
    for name in albums_and_tracks.keys():
        connection.execute('INSERT INTO list_performers(name_nickname)'
                           'VALUES(%s);', (name,))

    # Заполняем таблицу названиями жанров
    for genre in genres_and_id:
        connection.execute('INSERT INTO list_genres(genre_name)'
                           'VALUES(%s);', (genres_and_id.get(genre),))

    # Заполняем таблицу исполнитель(цифра) - жанр(цифра)
    id_performer = 0
    for key, val in albums_and_tracks.items():
        id_performer += 1
        for i in range(0, len(val[0])):
            connection.execute('INSERT INTO genre_performer(id_performer, id_genre)'
                               'VALUES(%s, %s);', (id_performer, val[0][i],))

    # Заполняем таблицу Названиями альбомов и их годами релиза
    for i in range(0, len(albums_and_tracks)):
        for album in albums_and_tracks.get(list(albums_and_tracks.keys())[i])[1][0].keys():
            release = albums_and_tracks.get(list(albums_and_tracks.keys())[i])[1][0][album][1][0]
            connection.execute('INSERT INTO albums(name_album, release_date)'
                               'VALUES(%s, %s);', (album, release))

    # Заполняем таблицу Названиями альбомов и их Исполнителец
    id_album = 0
    for i in range(0, len(albums_and_tracks)):
        id_performer = i+1
        for album in albums_and_tracks.get(list(albums_and_tracks.keys())[i])[1][0].keys():
            id_album += 1
            connection.execute('INSERT INTO performers_in_album(id_album, id_performer)'
                               'VALUES(%s, %s);', (id_album, id_performer))

    # Заполняем таблицу треков
    id_album = 0
    for i in range(0, len(albums_and_tracks)):
        for album in albums_and_tracks.get(list(albums_and_tracks.keys())[i])[1][0].keys():
            id_album += 1
            track_in_album = albums_and_tracks.get(list(albums_and_tracks.keys())[i])[1][0].get(album)[0]
            for track in track_in_album:
                if track[1] > 0:
                    duration = (track[1] * 60) + track[2]
                else:
                    duration = track[1] + track[2]
                connection.execute('INSERT INTO tracks(name_track, id_album, duration)'
                                   'VALUES(%s, %s, %s);', (track[0], id_album, duration))

    # Заполняем таблицу коллекций(имя и дата_релиз)
    for collection in collect.keys():
        release = collect.get(collection)[1][0]
        connection.execute('INSERT INTO collections(name_collection, release_date)'
                           'VALUES(%s, %s);', (collection, release))

    # Заполняем таблицу tracks_in_collection треков в колекциях
    for collection in collect.keys():
        # Получаем id коллекции из БД
        id_collection = connection.execute("""SELECT id_collection FROM collections
            WHERE name_collection LIKE %s;""", collection).fetchall()[0][0]
        # Получаем id_track из БД
        for i in range(0, len(collect.get(collection)[0])):
            name_track = collect.get(collection)[0][i][0]
            id_track = connection.execute("""SELECT id_track FROM tracks
            WHERE name_track LIKE %s;""", name_track).fetchall()[0][0]
            # Заполняем таблицу
            connection.execute('INSERT INTO tracks_in_collection(id_collection, id_track)'
                               'VALUES(%s, %s);', (id_collection, id_track))
